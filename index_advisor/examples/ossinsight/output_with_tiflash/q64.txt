Alias: q64
Query: 
WITH contributions AS (     SELECT         type,         repo_id,         FIRST_VALUE(repo_name) OVER (PARTITION BY repo_id ORDER BY created_at DESC) AS repo_name     FROM github_events ge     WHERE         actor_id = 923947         AND (             (type = 'PullRequestEvent' AND action = 'opened') OR             (type = 'IssuesEvent' AND action = 'opened') OR             (type = 'IssueCommentEvent' AND action = 'created') OR             (type = 'PullRequestReviewEvent' AND action = 'created') OR             (type = 'PullRequestReviewCommentEvent' AND action = 'created') OR             (type = 'PushEvent' AND action = '')         )          ) SELECT     repo_id,     repo_name,     CASE type         WHEN 'IssuesEvent' THEN 'issues'         WHEN 'IssueCommentEvent' THEN 'issue_comments'         WHEN 'PullRequestEvent' THEN 'pull_requests'         WHEN 'PullRequestReviewEvent' THEN 'reviews'         WHEN 'PullRequestReviewCommentEvent' THEN 'review_comments'         WHEN 'PushEvent' THEN 'pushes'     END AS type,     COUNT(1) AS cnt  FROM contributions c GROUP BY repo_id, type ORDER BY repo_id, type

Original Cost: 1.27E+05
Optimized Cost: 1.27E+05
Cost Reduction Ratio: 1.00


===================== original plan =====================
Sort_19                                   4.84     126613.17    root                                                                                                                                                         gharchive_dev.github_events.repo_id, Column#81                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
└─Projection_21                           4.84     125950.48    root                                                                                                                                                         gharchive_dev.github_events.repo_id, Column#76, case(eq(gharchive_dev.github_events.type, IssuesEvent), issues, eq(gharchive_dev.github_events.type, IssueCommentEvent), issue_comments, eq(gharchive_dev.github_events.type, PullRequestEvent), pull_requests, eq(gharchive_dev.github_events.type, PullRequestReviewEvent), reviews, eq(gharchive_dev.github_events.type, PullRequestReviewCommentEvent), review_comments, eq(gharchive_dev.github_events.type, PushEvent), pushes)->Column#81, Column#80    
  └─HashAgg_25                            4.84     125900.73    root                                                                                                                                                         group by:gharchive_dev.github_events.repo_id, gharchive_dev.github_events.type, funcs:count(1)->Column#80, funcs:firstrow(gharchive_dev.github_events.type)->gharchive_dev.github_events.type, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id, funcs:firstrow(Column#76)->Column#76                                                                                                                                                                                  
    └─Shuffle_49                          52.84    120531.36    root                                                                                                                                                         execution info: concurrency:4, data sources:[IndexLookUp_47]                                                                                                                                                                                                                                                                                                                                                                                                                                                   
      └─Window_30                         52.84    120531.36    root                                                                                                                                                         first_value(gharchive_dev.github_events.repo_name)->Column#76 over(partition by gharchive_dev.github_events.repo_id order by gharchive_dev.github_events.created_at desc range between unbounded preceding and current row)                                                                                                                                                                                                                                                                                    
        └─Sort_48                         52.84    120531.36    root                                                                                                                                                         gharchive_dev.github_events.repo_id, gharchive_dev.github_events.created_at:desc                                                                                                                                                                                                                                                                                                                                                                                                                               
          └─IndexLookUp_47                52.84    104361.77    root         partition:push_event,pull_request_event,issue_comment_event,issues_event,pull_request_review_comment_event,pull_request_review_event                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
            ├─IndexRangeScan_45(Build)    52.84    14475.69     cop[tikv]    table:ge, index:index_ge_on_actor_id_type_action_created_at_repo_id_commits(actor_id, type, action, created_at, repo_id, push_distinct_size)    range:[923947 "IssueCommentEvent" "created",923947 "IssueCommentEvent" "created"], [923947 "IssuesEvent" "opened",923947 "IssuesEvent" "opened"], [923947 "PullRequestEvent" "opened",923947 "PullRequestEvent" "opened"], [923947 "PullRequestReviewCommentEvent" "created",923947 "PullRequestReviewCommentEvent" "created"], [923947 "PullRequestReviewEvent" "created",923947 "PullRequestReviewEvent" "created"], [923947 "PushEvent" "",923947 "PushEvent" ""], keep order:false                         
            └─TableRowIDScan_46(Probe)    52.84    19285.63     cop[tikv]    table:ge                                                                                                                                        keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

===================== optimized plan =====================
Sort_19                                   4.84     126613.17    root                                                                                                                                                         gharchive_dev.github_events.repo_id, Column#81                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
└─Projection_21                           4.84     125950.48    root                                                                                                                                                         gharchive_dev.github_events.repo_id, Column#76, case(eq(gharchive_dev.github_events.type, IssuesEvent), issues, eq(gharchive_dev.github_events.type, IssueCommentEvent), issue_comments, eq(gharchive_dev.github_events.type, PullRequestEvent), pull_requests, eq(gharchive_dev.github_events.type, PullRequestReviewEvent), reviews, eq(gharchive_dev.github_events.type, PullRequestReviewCommentEvent), review_comments, eq(gharchive_dev.github_events.type, PushEvent), pushes)->Column#81, Column#80    
  └─HashAgg_25                            4.84     125900.73    root                                                                                                                                                         group by:gharchive_dev.github_events.repo_id, gharchive_dev.github_events.type, funcs:count(1)->Column#80, funcs:firstrow(gharchive_dev.github_events.type)->gharchive_dev.github_events.type, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id, funcs:firstrow(Column#76)->Column#76                                                                                                                                                                                  
    └─Shuffle_49                          52.84    120531.36    root                                                                                                                                                         execution info: concurrency:4, data sources:[IndexLookUp_47]                                                                                                                                                                                                                                                                                                                                                                                                                                                   
      └─Window_30                         52.84    120531.36    root                                                                                                                                                         first_value(gharchive_dev.github_events.repo_name)->Column#76 over(partition by gharchive_dev.github_events.repo_id order by gharchive_dev.github_events.created_at desc range between unbounded preceding and current row)                                                                                                                                                                                                                                                                                    
        └─Sort_48                         52.84    120531.36    root                                                                                                                                                         gharchive_dev.github_events.repo_id, gharchive_dev.github_events.created_at:desc                                                                                                                                                                                                                                                                                                                                                                                                                               
          └─IndexLookUp_47                52.84    104361.77    root         partition:push_event,pull_request_event,issue_comment_event,issues_event,pull_request_review_comment_event,pull_request_review_event                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
            ├─IndexRangeScan_45(Build)    52.84    14475.69     cop[tikv]    table:ge, index:index_ge_on_actor_id_type_action_created_at_repo_id_commits(actor_id, type, action, created_at, repo_id, push_distinct_size)    range:[923947 "IssueCommentEvent" "created",923947 "IssueCommentEvent" "created"], [923947 "IssuesEvent" "opened",923947 "IssuesEvent" "opened"], [923947 "PullRequestEvent" "opened",923947 "PullRequestEvent" "opened"], [923947 "PullRequestReviewCommentEvent" "created",923947 "PullRequestReviewCommentEvent" "created"], [923947 "PullRequestReviewEvent" "created",923947 "PullRequestReviewEvent" "created"], [923947 "PushEvent" "",923947 "PushEvent" ""], keep order:false                         
            └─TableRowIDScan_46(Probe)    52.84    19285.63     cop[tikv]    table:ge                                                                                                                                        keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               