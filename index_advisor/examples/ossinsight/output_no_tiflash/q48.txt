Alias: q48
Query: 
/* questionId: e4871274-6108-48ff-9b8a-34383b2d0961 */ SELECT gu.organization AS organization, COUNT(*) AS push_requests FROM github_events AS ge JOIN github_users AS gu ON ge.actor_id = gu.id WHERE ge.type = 'PushEvent' AND ge.created_at > DATE_SUB(NOW(), INTERVAL 3 MONTH) AND gu.type = 'ORG' GROUP BY organization ORDER BY push_requests DESC LIMIT 20

Original Cost: 6.34E+03
Optimized Cost: 6.34E+03
Cost Reduction Ratio: 1.00


===================== original plan =====================
Projection_12                         1.00    6335.91    root                                                                          gharchive_dev.github_users.organization, Column#56                                                                                                                                                               
└─TopN_15                             1.00    6335.71    root                                                                          Column#56:desc, offset:0, count:20                                                                                                                                                                               
  └─HashAgg_20                        1.00    5516.05    root                                                                          group by:gharchive_dev.github_users.organization, funcs:count(1)->Column#56, funcs:firstrow(gharchive_dev.github_users.organization)->gharchive_dev.github_users.organization                                    
    └─IndexJoin_29                    0.00    3953.03    root                                                                          inner join, inner:TableReader_25, outer key:gharchive_dev.github_events.actor_id, inner key:gharchive_dev.github_users.id, equal cond:eq(gharchive_dev.github_events.actor_id, gharchive_dev.github_users.id)    
      ├─IndexLookUp_54(Build)         0.00    1955.12    root         partition:push_event                                                                                                                                                                                                                                                              
      │ ├─IndexRangeScan_51(Build)    0.00    203.50     cop[tikv]    table:ge, index:index_github_events_on_created_at(created_at)    range:(2023-12-12 16:36:38,+inf], keep order:false                                                                                                                                                               
      │ └─Selection_53(Probe)         0.00    414.87     cop[tikv]                                                                     eq(gharchive_dev.github_events.type, "PushEvent")                                                                                                                                                                
      │   └─TableRowIDScan_52         0.00    364.97     cop[tikv]    table:ge                                                         keep order:false                                                                                                                                                                                                 
      └─TableReader_25(Probe)         0.00    33.41      root                                                                          data:Selection_24                                                                                                                                                                                                
        └─Selection_24                0.00    471.14     cop[tikv]                                                                     eq(gharchive_dev.github_users.type, "ORG")                                                                                                                                                                       
          └─TableRangeScan_23         0.00    421.24     cop[tikv]    table:gu                                                         range: decided by [gharchive_dev.github_events.actor_id], keep order:false                                                                                                                                       

===================== optimized plan =====================
Projection_12                         1.00    6335.91    root                                                                          gharchive_dev.github_users.organization, Column#56                                                                                                                                                               
└─TopN_15                             1.00    6335.71    root                                                                          Column#56:desc, offset:0, count:20                                                                                                                                                                               
  └─HashAgg_20                        1.00    5516.05    root                                                                          group by:gharchive_dev.github_users.organization, funcs:count(1)->Column#56, funcs:firstrow(gharchive_dev.github_users.organization)->gharchive_dev.github_users.organization                                    
    └─IndexJoin_31                    0.00    3953.03    root                                                                          inner join, inner:TableReader_27, outer key:gharchive_dev.github_events.actor_id, inner key:gharchive_dev.github_users.id, equal cond:eq(gharchive_dev.github_events.actor_id, gharchive_dev.github_users.id)    
      ├─IndexLookUp_66(Build)         0.00    1955.12    root         partition:push_event                                                                                                                                                                                                                                                              
      │ ├─IndexRangeScan_63(Build)    0.00    203.50     cop[tikv]    table:ge, index:index_github_events_on_created_at(created_at)    range:(2023-12-12 16:36:38,+inf], keep order:false                                                                                                                                                               
      │ └─Selection_65(Probe)         0.00    414.87     cop[tikv]                                                                     eq(gharchive_dev.github_events.type, "PushEvent")                                                                                                                                                                
      │   └─TableRowIDScan_64         0.00    364.97     cop[tikv]    table:ge                                                         keep order:false                                                                                                                                                                                                 
      └─TableReader_27(Probe)         0.00    33.41      root                                                                          data:Selection_26                                                                                                                                                                                                
        └─Selection_26                0.00    471.14     cop[tikv]                                                                     eq(gharchive_dev.github_users.type, "ORG")                                                                                                                                                                       
          └─TableRangeScan_25         0.00    421.24     cop[tikv]    table:gu                                                         range: decided by [gharchive_dev.github_events.actor_id], keep order:false                                                                                                                                       