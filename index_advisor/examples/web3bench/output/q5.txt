Alias: q5
Query: 
Select count(*) from token_transfers where token_address = '0x7a93f0d9f302c0818022f8dca6ee1eb0f1b50308'

Original Cost: 1.39E+08
Optimized Cost: 8.95E+04
Cost Reduction Ratio: 0.00


===================== original plan =====================
HashAgg_13                  1.00          138711730.66     root                                  funcs:count(Column#10)->Column#9                                                            
└─TableReader_14            1.00          138710203.40     root                                  data:HashAgg_6                                                                              
  └─HashAgg_6               1.00          2080653019.31    cop[tikv]                             funcs:count(1)->Column#10                                                                   
    └─Selection_12          1365.00       2080624266.61    cop[tikv]                             eq(ethereum.token_transfers.token_address, "0x7a93f0d9f302c0818022f8dca6ee1eb0f1b50308")    
      └─TableFullScan_11    5397104.00    1811308777.01    cop[tikv]    table:token_transfers    keep order:false                                                                            

===================== optimized plan =====================
HashAgg_12                 1.00       89501.01      root                                                                          funcs:count(Column#10)->Column#9                                                                                       
└─IndexReader_13           1.00       87973.75      root                                                                          index:HashAgg_6                                                                                                        
  └─HashAgg_6              1.00       1319574.59    cop[tikv]                                                                     funcs:count(1)->Column#10                                                                                              
    └─IndexRangeScan_11    5397.10    1210341.09    cop[tikv]    table:token_transfers, index:idx_token_address(token_address)    range:["0x7a93f0d9f302c0818022f8dca6ee1eb0f1b50308","0x7a93f0d9f302c0818022f8dca6ee1eb0f1b50308"], keep order:false    
    
 
 
 
mysql> explain analyze Select count(*) from token_transfers where token_address = '0x7a93f0d9f302c0818022f8dca6ee1eb0f1b50308';
+------------------------------+-----------+---------+-----------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+-----------+------+
| id                           | estRows   | actRows | task      | access object         | execution info                                                                                                                                                                                                                                                                                                                                                                 | operator info                                                                            | memory    | disk |
+------------------------------+-----------+---------+-----------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+-----------+------+
| HashAgg_13                   | 1.00      | 1       | root      |                       | time:88.7ms, loops:2, RU:3808.158830, partial_worker:{wall_time:88.677483ms, concurrency:5, task_num:1, tot_wait:443.197416ms, tot_exec:4.542µs, tot_time:443.208463ms, max:88.645514ms, p95:88.645514ms}, final_worker:{wall_time:88.70634ms, concurrency:5, task_num:1, tot_wait:443.332192ms, tot_exec:17.986µs, tot_time:443.352925ms, max:88.676063ms, p95:88.676063ms}   | funcs:count(Column#10)->Column#9                                                         | 9.86 KB   | N/A  |
| └─TableReader_14             | 1.00      | 7       | root      |                       | time:88.6ms, loops:2, cop_task: {num: 7, max: 88.6ms, min: 60.3ms, avg: 72ms, p95: 88.6ms, max_proc_keys: 130504, p95_proc_keys: 130504, tot_proc: 499.8ms, tot_wait: 430.7µs, rpc_num: 7, rpc_time: 503.5ms, copr_cache_hit_ratio: 0.00, build_task_duration: 15.8µs, max_distsql_concurrency: 7}                                                                             | data:HashAgg_6                                                                           | 396 Bytes | N/A  |
|   └─HashAgg_6                | 1.00      | 7       | cop[tikv] |                       | tikv_task:{proc max:88ms, min:59ms, avg: 71.1ms, p80:82ms, p95:88ms, iters:878, tasks:7}, scan_detail: {total_process_keys: 895725, total_process_keys_size: 238434431, total_keys: 895732, get_snapshot_time: 342.7µs, rocksdb: {key_skipped_count: 895725, block: {cache_hit_count: 7704}}}                                                                                  | funcs:count(1)->Column#10                                                                | N/A       | N/A  |
|     └─Selection_12           | 1688.00   | 1704    | cop[tikv] |                       | tikv_task:{proc max:88ms, min:59ms, avg: 70.9ms, p80:82ms, p95:88ms, iters:878, tasks:7}                                                                                                                                                                                                                                                                                       | eq(ethereum.token_transfers.token_address, "0x7a93f0d9f302c0818022f8dca6ee1eb0f1b50308") | N/A       | N/A  |
|       └─TableFullScan_11     | 895725.00 | 895725  | cop[tikv] | table:token_transfers | tikv_task:{proc max:73ms, min:40ms, avg: 56.3ms, p80:72ms, p95:73ms, iters:878, tasks:7}                                                                                                                                                                                                                                                                                       | keep order:false                                                                         | N/A       | N/A  |
+------------------------------+-----------+---------+-----------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+-----------+------+
5 rows in set (0.09 sec)






mysql> explain analyze Select count(*) from token_transfers where token_address = '0x7a93f0d9f302c0818022f8dca6ee1eb0f1b50308';
+-----------------------------+---------+---------+-----------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------+-----------+------+
| id                          | estRows | actRows | task      | access object                                                 | execution info                                                                                                                                                                                                                                                                                                                                                   | operator info                                                                                                       | memory    | disk |
+-----------------------------+---------+---------+-----------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------+-----------+------+
| HashAgg_12                  | 1.00    | 1       | root      |                                                               | time:2.22ms, loops:2, RU:4.905920, partial_worker:{wall_time:2.172882ms, concurrency:5, task_num:1, tot_wait:10.746109ms, tot_exec:4.233µs, tot_time:10.75619ms, max:2.156824ms, p95:2.156824ms}, final_worker:{wall_time:2.215647ms, concurrency:5, task_num:1, tot_wait:10.875218ms, tot_exec:15.409µs, tot_time:10.89307ms, max:2.194836ms, p95:2.194836ms}   | funcs:count(Column#10)->Column#9                                                                                    | 37.6 KB   | N/A  |
| └─IndexReader_13            | 1.00    | 1       | root      |                                                               | time:2.13ms, loops:2, cop_task: {num: 1, max: 2.11ms, proc_keys: 1704, tot_proc: 1.51ms, tot_wait: 154.7µs, rpc_num: 1, rpc_time: 2.08ms, copr_cache_hit_ratio: 0.00, build_task_duration: 9.57µs, max_distsql_concurrency: 1}                                                                                                                                   | index:HashAgg_6                                                                                                     | 356 Bytes | N/A  |
|   └─HashAgg_6               | 1.00    | 1       | cop[tikv] |                                                               | tikv_task:{time:2ms, loops:2}, scan_detail: {total_process_keys: 1704, total_process_keys_size: 257304, total_keys: 1705, get_snapshot_time: 123µs, rocksdb: {key_skipped_count: 1704, block: {cache_hit_count: 1, read_count: 7, read_byte: 10.7 KB, read_time: 26.2µs}}}                                                                                       | funcs:count(1)->Column#10                                                                                           | N/A       | N/A  |
|     └─IndexRangeScan_11     | 1664.00 | 1704    | cop[tikv] | table:token_transfers, index:idx_token_address(token_address) | tikv_task:{time:2ms, loops:2}                                                                                                                                                                                                                                                                                                                                    | range:["0x7a93f0d9f302c0818022f8dca6ee1eb0f1b50308","0x7a93f0d9f302c0818022f8dca6ee1eb0f1b50308"], keep order:false | N/A       | N/A  |
+-----------------------------+---------+---------+-----------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------+-----------+------+
4 rows in set (0.00 sec)




