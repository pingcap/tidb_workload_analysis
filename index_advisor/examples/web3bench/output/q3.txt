Alias: q3
Query: 
Select *  from transactions
where hash in ('0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c',
'0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8',
'0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1',
'0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd') and to_address <> from_address

Original Cost: 7.51E+08
Optimized Cost: 1.92E+08
Cost Reduction Ratio: 0.26


===================== original plan =====================
TableReader_7          3.20           751437092.27      root                               data:Selection_6                                                                                                                                                                                                                                                                                                                                                                                    
└─Selection_6          3.20           11271549686.80    cop[tikv]                          in(ethereum.transactions.hash, "0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c", "0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8", "0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1", "0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd"), ne(ethereum.transactions.to_address, ethereum.transactions.from_address)    
  └─TableFullScan_5    23996584.00    8876690603.60     cop[tikv]    table:transactions    keep order:false                                                                                                                                                                                                                                                                                                                                                                                    

===================== optimized plan =====================
IndexLookUp_11               3.20        191725468.58    root                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
├─IndexRangeScan_8(Build)    95986.34    25099226.52     cop[tikv]    table:transactions, index:idx_hash(hash)    range:["0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c","0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c"], ["0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1","0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1"], ["0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8","0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8"], ["0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd","0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd"], keep order:false    
└─Selection_10(Probe)        3.20        40296480.58     cop[tikv]                                                ne(ethereum.transactions.to_address, ethereum.transactions.from_address)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  └─TableRowIDScan_9         95986.34    35506762.41     cop[tikv]    table:transactions                          keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
  
  
 


mysql> explain analyze Select *  from transactions where hash in ('0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c', '0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8', '0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1', '0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd') and to_address <> from_address;
+-------------------------+------------+---------+-----------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| id                      | estRows    | actRows | task      | access object      | execution info                                                                                                                                                                                                                                                                                                                         | operator info                                                                                                                                                                                                                                                                                                                                                                                    | memory  | disk |
+-------------------------+------------+---------+-----------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| TableReader_7           | 3.21       | 4       | root      |                    | time:263.7ms, loops:2, RU:11709.137477, cop_task: {num: 71, max: 148.7ms, min: 180.5µs, avg: 35.7ms, p95: 130.7ms, max_proc_keys: 81748, p95_proc_keys: 79504, tot_proc: 2.51s, tot_wait: 2.03ms, rpc_num: 71, rpc_time: 2.54s, copr_cache_hit_ratio: 0.70, build_task_duration: 114.6µs, max_distsql_concurrency: 15}                 | data:Selection_6                                                                                                                                                                                                                                                                                                                                                                                 | 2.79 KB | N/A  |
| └─Selection_6           | 3.21       | 4       | cop[tikv] |                    | tikv_task:{proc max:190ms, min:99ms, avg: 127.5ms, p80:148ms, p95:171ms, iters:5587, tasks:71}, scan_detail: {total_process_keys: 1585815, total_process_keys_size: 710384849, total_keys: 1585836, get_snapshot_time: 867.7µs, rocksdb: {delete_skipped_count: 402465, key_skipped_count: 3574074, block: {cache_hit_count: 24046}}}  | in(ethereum.transactions.hash, "0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c", "0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8", "0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1", "0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd"), ne(ethereum.transactions.to_address, ethereum.transactions.from_address) | N/A     | N/A  |
|   └─TableFullScan_5     | 5395060.00 | 5395060 | cop[tikv] | table:transactions | tikv_task:{proc max:181ms, min:89ms, avg: 116.1ms, p80:135ms, p95:157ms, iters:5587, tasks:71}                                                                                                                                                                                                                                         | keep order:false                                                                                                                                                                                                                                                                                                                                                                                 | N/A     | N/A  |
+-------------------------+------------+---------+-----------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
3 rows in set (0.27 sec)

mysql> explain analyze Select *  from transactions where hash in ('0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c', '0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8', '0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1', '0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd') and to_address <> from_address;
+-------------------------+------------+---------+-----------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| id                      | estRows    | actRows | task      | access object      | execution info                                                                                                                                                                                                                                                                                                                         | operator info                                                                                                                                                                                                                                                                                                                                                                                    | memory  | disk |
+-------------------------+------------+---------+-----------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| TableReader_7           | 3.21       | 4       | root      |                    | time:263.2ms, loops:2, RU:11733.622211, cop_task: {num: 71, max: 148.5ms, min: 168.2µs, avg: 36.8ms, p95: 138.2ms, max_proc_keys: 81748, p95_proc_keys: 79504, tot_proc: 2.58s, tot_wait: 2.16ms, rpc_num: 71, rpc_time: 2.61s, copr_cache_hit_ratio: 0.70, build_task_duration: 177.3µs, max_distsql_concurrency: 15}                 | data:Selection_6                                                                                                                                                                                                                                                                                                                                                                                 | 3.24 KB | N/A  |
| └─Selection_6           | 3.21       | 4       | cop[tikv] |                    | tikv_task:{proc max:190ms, min:92ms, avg: 128.4ms, p80:148ms, p95:171ms, iters:5587, tasks:71}, scan_detail: {total_process_keys: 1585815, total_process_keys_size: 710384849, total_keys: 1585836, get_snapshot_time: 855.9µs, rocksdb: {delete_skipped_count: 402465, key_skipped_count: 3574074, block: {cache_hit_count: 24046}}}  | in(ethereum.transactions.hash, "0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c", "0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8", "0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1", "0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd"), ne(ethereum.transactions.to_address, ethereum.transactions.from_address) | N/A     | N/A  |
|   └─TableFullScan_5     | 5395060.00 | 5395060 | cop[tikv] | table:transactions | tikv_task:{proc max:181ms, min:81ms, avg: 116.7ms, p80:135ms, p95:157ms, iters:5587, tasks:71}                                                                                                                                                                                                                                         | keep order:false                                                                                                                                                                                                                                                                                                                                                                                 | N/A     | N/A  |
+-------------------------+------------+---------+-----------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
3 rows in set (0.26 sec)









mysql> explain analyze Select *  from transactions
    -> where hash in ('0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c',
    -> '0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8',
    -> '0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1',
    -> '0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd') and to_address <> from_address;
+-------------------------------+---------+---------+-----------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| id                            | estRows | actRows | task      | access object                            | execution info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | operator info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | memory  | disk |
+-------------------------------+---------+---------+-----------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| IndexLookUp_11                | 3.21    | 4       | root      |                                          | time:1.99ms, loops:2, RU:2.345727, index_task: {total_time: 1.11ms, fetch_handle: 1.11ms, build: 872ns, wait: 2.72µs}, table_task: {total_time: 743.5µs, num: 1, concurrency: 5}, next: {wait_index: 1.23ms, wait_table_lookup_build: 92.1µs, wait_table_lookup_resp: 644µs}                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 16.4 KB | N/A  |
| ├─IndexRangeScan_8(Build)     | 4.01    | 4       | cop[tikv] | table:transactions, index:idx_hash(hash) | time:1.1ms, loops:3, cop_task: {num: 3, max: 1.04ms, min: 868.6µs, avg: 931.6µs, p95: 1.04ms, max_proc_keys: 2, p95_proc_keys: 2, tot_proc: 1.07ms, tot_wait: 571.1µs, rpc_num: 3, rpc_time: 2.73ms, copr_cache_hit_ratio: 0.00, build_task_duration: 37.4µs, max_distsql_concurrency: 3}, tikv_task:{proc max:0s, min:0s, avg: 0s, p80:0s, p95:0s, iters:3, tasks:3}, scan_detail: {total_process_keys: 4, total_process_keys_size: 808, total_keys: 8, get_snapshot_time: 424.4µs, rocksdb: {key_skipped_count: 4, block: {cache_hit_count: 14, read_count: 10, read_byte: 87.1 KB, read_time: 54.2µs}}}       | range:["0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c","0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c"], ["0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1","0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1"], ["0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8","0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8"], ["0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd","0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd"], keep order:false | N/A     | N/A  |
| └─Selection_10(Probe)         | 3.21    | 4       | cop[tikv] |                                          | time:613.2µs, loops:2, cop_task: {num: 1, max: 555µs, proc_keys: 4, tot_proc: 166.5µs, tot_wait: 70.8µs, rpc_num: 1, rpc_time: 542µs, copr_cache_hit_ratio: 0.00, build_task_duration: 41.9µs, max_distsql_concurrency: 1, max_extra_concurrency: 1}, tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 4, total_process_keys_size: 1362, total_keys: 4, get_snapshot_time: 50.7µs, rocksdb: {block: {cache_hit_count: 14}}}                                                                                                                                                                       | ne(ethereum.transactions.to_address, ethereum.transactions.from_address)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | N/A     | N/A  |
|   └─TableRowIDScan_9          | 4.01    | 4       | cop[tikv] | table:transactions                       | tikv_task:{time:0s, loops:1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | N/A     | N/A  |
+-------------------------------+---------+---------+-----------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
4 rows in set (0.01 sec)

mysql> explain analyze Select *  from transactions where hash in ('0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c', '0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8', '0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1', '0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd') and to_address <> from_address;
+-------------------------------+---------+---------+-----------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| id                            | estRows | actRows | task      | access object                            | execution info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | operator info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | memory  | disk |
+-------------------------------+---------+---------+-----------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| IndexLookUp_11                | 3.21    | 4       | root      |                                          | time:1.52ms, loops:2, RU:2.092418, index_task: {total_time: 735.5µs, fetch_handle: 733.2µs, build: 1.12µs, wait: 1.21µs}, table_task: {total_time: 640.4µs, num: 1, concurrency: 5}, next: {wait_index: 863.9µs, wait_table_lookup_build: 66.1µs, wait_table_lookup_resp: 558.9µs}                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 16.4 KB | N/A  |
| ├─IndexRangeScan_8(Build)     | 4.01    | 4       | cop[tikv] | table:transactions, index:idx_hash(hash) | time:725.8µs, loops:3, cop_task: {num: 3, max: 634.7µs, min: 593.5µs, avg: 607.7µs, p95: 634.7µs, max_proc_keys: 2, p95_proc_keys: 2, tot_proc: 351.8µs, tot_wait: 169.5µs, rpc_num: 3, rpc_time: 1.75ms, copr_cache_hit_ratio: 0.00, build_task_duration: 31.9µs, max_distsql_concurrency: 3}, tikv_task:{proc max:0s, min:0s, avg: 0s, p80:0s, p95:0s, iters:3, tasks:3}, scan_detail: {total_process_keys: 4, total_process_keys_size: 808, total_keys: 8, get_snapshot_time: 65.2µs, rocksdb: {key_skipped_count: 4, block: {cache_hit_count: 12}}}          | range:["0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c","0x1f415defb2729863fd8088727900d99b7df6f03d5e22e2105fc984cac3d0fb1c"], ["0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1","0x5dee984c63cc26037a81d0f2861565c4e0c21a87ebf165b331faec347d7a76a1"], ["0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8","0xbeff7a4cf341d10c6293a2ecfb255f39c21836bf8956c6877d0f2486794fd5b8"], ["0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd","0xc7da1e3391e4b7769fffe8e6afc284175a6cbe5fd9b333d9c0585944a36118dd"], keep order:false | N/A     | N/A  |
| └─Selection_10(Probe)         | 3.21    | 4       | cop[tikv] |                                          | time:534.2µs, loops:2, cop_task: {num: 1, max: 473.4µs, proc_keys: 4, tot_proc: 126.1µs, tot_wait: 36.9µs, rpc_num: 1, rpc_time: 460.1µs, copr_cache_hit_ratio: 0.00, build_task_duration: 29.4µs, max_distsql_concurrency: 1, max_extra_concurrency: 1}, tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 4, total_process_keys_size: 1362, total_keys: 4, get_snapshot_time: 16.1µs, rocksdb: {block: {cache_hit_count: 14}}}                                                                                                                   | ne(ethereum.transactions.to_address, ethereum.transactions.from_address)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | N/A     | N/A  |
|   └─TableRowIDScan_9          | 4.01    | 4       | cop[tikv] | table:transactions                       | tikv_task:{time:0s, loops:1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | N/A     | N/A  |
+-------------------------------+---------+---------+-----------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
4 rows in set (0.00 sec)
