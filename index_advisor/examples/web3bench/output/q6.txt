Alias: q6
Query: 
SELECT * FROM transactions
WHERE from_address = '0x31d118c5f75502b96ca21d3d0d3fb8d7b19fed24' OR to_address = '0x6364989a903f45798c7a292778285a83d0928608'
ORDER BY block_timestamp DESC LIMIT 10

Original Cost: 6.72E+08
Optimized Cost: 2.03E+06
Cost Reduction Ratio: 0.00


===================== original plan =====================
TopN_8                      7.65           671612684.04      root                               ethereum.transactions.block_timestamp:desc, offset:0, count:10                                                                                                                  
└─TableReader_16            7.65           671609816.21      root                               data:TopN_15                                                                                                                                                                    
  └─TopN_15                 7.65           10074123013.03    cop[tikv]                          ethereum.transactions.block_timestamp:desc, offset:0, count:10                                                                                                                  
    └─Selection_14          7.65           10074120145.20    cop[tikv]                          or(eq(ethereum.transactions.from_address, "0x31d118c5f75502b96ca21d3d0d3fb8d7b19fed24"), eq(ethereum.transactions.to_address, "0x6364989a903f45798c7a292778285a83d0928608"))    
      └─TableFullScan_13    23996584.00    8876690603.60     cop[tikv]    table:transactions    keep order:false                                                                                                                                                                

===================== optimized plan =====================
TopN_10                         7.65        2028339.11    root                                                                                                               ethereum.transactions.block_timestamp:desc, offset:0, count:10                                                         
└─IndexMerge_30                 7.65        2025471.28    root                                                                                                               type: union                                                                                                            
  ├─IndexRangeScan_27(Build)    23996.58    5805424.83    cop[tikv]    table:transactions, index:idx_from_address(from_address)                                              range:["0x31d118c5f75502b96ca21d3d0d3fb8d7b19fed24","0x31d118c5f75502b96ca21d3d0d3fb8d7b19fed24"], keep order:false    
  ├─IndexRangeScan_28(Build)    23996.58    6805912.36    cop[tikv]    table:transactions, index:idx_to_address_block_timestamp_value(to_address, block_timestamp, value)    range:["0x6364989a903f45798c7a292778285a83d0928608","0x6364989a903f45798c7a292778285a83d0928608"], keep order:false    
  └─TableRowIDScan_29(Probe)    7.65        2829.26       cop[tikv]    table:transactions                                                                                    keep order:false                                                                                                       
  
  
  
  
  
  
mysql> explain analyze SELECT * FROM transactions WHERE from_address = '0x31d118c5f75502b96ca21d3d0d3fb8d7b19fed24' OR to_address = '0x6364989a903f45798c7a292778285a83d0928608' ORDER BY block_timestamp DESC LIMIT 10;
+------------------------------+------------+---------+-----------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| id                           | estRows    | actRows | task      | access object      | execution info                                                                                                                                                                                                                                                                                                                       | operator info                                                                                                                                                                | memory  | disk |
+------------------------------+------------+---------+-----------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| TopN_8                       | 6.15       | 10      | root      |                    | time:247.6ms, loops:2, RU:11758.757762                                                                                                                                                                                                                                                                                               | ethereum.transactions.block_timestamp:desc, offset:0, count:10                                                                                                               | 13.4 KB | N/A  |
| └─TableReader_16             | 6.15       | 22      | root      |                    | time:247.5ms, loops:4, cop_task: {num: 71, max: 177.7ms, min: 186.5µs, avg: 37.8ms, p95: 153.9ms, max_proc_keys: 81748, p95_proc_keys: 79504, tot_proc: 2.66s, tot_wait: 2.12ms, rpc_num: 71, rpc_time: 2.69s, copr_cache_hit_ratio: 0.70, build_task_duration: 133.7µs, max_distsql_concurrency: 15}                                | data:TopN_15                                                                                                                                                                 | 5.82 KB | N/A  |
|   └─TopN_15                  | 6.15       | 22      | cop[tikv] |                    | tikv_task:{proc max:205ms, min:94ms, avg: 134.5ms, p80:153ms, p95:185ms, iters:5299, tasks:71}, scan_detail: {total_process_keys: 1585815, total_process_keys_size: 710384849, total_keys: 1585836, get_snapshot_time: 897µs, rocksdb: {delete_skipped_count: 402465, key_skipped_count: 3574074, block: {cache_hit_count: 24046}}}  | ethereum.transactions.block_timestamp:desc, offset:0, count:10                                                                                                               | N/A     | N/A  |
|     └─Selection_14           | 6.15       | 32      | cop[tikv] |                    | tikv_task:{proc max:205ms, min:94ms, avg: 134.2ms, p80:153ms, p95:184ms, iters:5299, tasks:71}                                                                                                                                                                                                                                       | or(eq(ethereum.transactions.from_address, "0x31d118c5f75502b96ca21d3d0d3fb8d7b19fed24"), eq(ethereum.transactions.to_address, "0x6364989a903f45798c7a292778285a83d0928608")) | N/A     | N/A  |
|       └─TableFullScan_13     | 5395060.00 | 5395060 | cop[tikv] | table:transactions | tikv_task:{proc max:181ms, min:80ms, avg: 119.1ms, p80:136ms, p95:170ms, iters:5299, tasks:71}                                                                                                                                                                                                                                       | keep order:false                                                                                                                                                             | N/A     | N/A  |
+------------------------------+------------+---------+-----------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
5 rows in set (0.25 sec)






mysql> explain analyze SELECT * FROM transactions
    -> WHERE from_address = '0x31d118c5f75502b96ca21d3d0d3fb8d7b19fed24' OR to_address = '0x6364989a903f45798c7a292778285a83d0928608'
    -> ORDER BY block_timestamp DESC LIMIT 10;
+----------------------------------+---------+---------+-----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| id                               | estRows | actRows | task      | access object                                                                                      | execution info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | operator info                                                                                                                                           | memory  | disk |
+----------------------------------+---------+---------+-----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| TopN_10                          | 6.24    | 10      | root      |                                                                                                    | time:3.44ms, loops:2, RU:3.674669                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | ethereum.transactions.block_timestamp:desc, offset:0, count:10                                                                                          | 15.8 KB | N/A  |
| └─IndexMerge_30                  | 6.24    | 32      | root      |                                                                                                    | time:3.39ms, loops:2, index_task:{fetch_handle:1.8246ms, merge:20.236µs}, table_task:{num:2, concurrency:5, fetch_row:4.085514ms, wait_time:2.105582ms}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | type: union                                                                                                                                             | 38.8 KB | N/A  |
|   ├─IndexRangeScan_27(Build)     | 3.17    | 19      | cop[tikv] | table:transactions, index:idx_from_address(from_address)                                           | time:858.4µs, loops:3, cop_task: {num: 1, max: 771.4µs, proc_keys: 19, tot_proc: 145.5µs, tot_wait: 144.1µs, rpc_num: 1, rpc_time: 741.7µs, copr_cache_hit_ratio: 0.00, build_task_duration: 28.1µs, max_distsql_concurrency: 1}, tikv_task:{time:1ms, loops:1}, scan_detail: {total_process_keys: 19, total_process_keys_size: 2869, total_keys: 20, get_snapshot_time: 105.3µs, rocksdb: {key_skipped_count: 19, block: {cache_hit_count: 4}}}                                                                                                                                                                                                     | range:["0x31d118c5f75502b96ca21d3d0d3fb8d7b19fed24","0x31d118c5f75502b96ca21d3d0d3fb8d7b19fed24"], keep order:false, stats:partial[idx_hash:allEvicted] | N/A     | N/A  |
|   ├─IndexRangeScan_28(Build)     | 3.07    | 13      | cop[tikv] | table:transactions, index:idx_to_address_block_timestamp_value(to_address, block_timestamp, value) | time:947.9µs, loops:3, cop_task: {num: 1, max: 868.9µs, proc_keys: 13, tot_proc: 263µs, tot_wait: 149.1µs, rpc_num: 1, rpc_time: 841.2µs, copr_cache_hit_ratio: 0.00, build_task_duration: 29µs, max_distsql_concurrency: 1}, tikv_task:{time:1ms, loops:1}, scan_detail: {total_process_keys: 13, total_process_keys_size: 2808, total_keys: 14, get_snapshot_time: 98.7µs, rocksdb: {key_skipped_count: 13, block: {cache_hit_count: 2, read_count: 1, read_byte: 7.75 KB, read_time: 14.9µs}}}                                                                                                                                                    | range:["0x6364989a903f45798c7a292778285a83d0928608","0x6364989a903f45798c7a292778285a83d0928608"], keep order:false, stats:partial[idx_hash:allEvicted] | N/A     | N/A  |
|   └─TableRowIDScan_29(Probe)     | 6.24    | 32      | cop[tikv] | table:transactions                                                                                 | time:3.87ms, loops:4, cop_task: {num: 14, max: 1.69ms, min: 0s, avg: 251.7µs, p95: 1.69ms, max_proc_keys: 19, p95_proc_keys: 19, tot_proc: 2.41ms, tot_wait: 873.5µs, rpc_num: 4, rpc_time: 3.47ms, copr_cache_hit_ratio: 0.00, build_task_duration: 62.9µs, max_distsql_concurrency: 1, max_extra_concurrency: 1, store_batch_num: 10}, tikv_task:{proc max:1ms, min:0s, avg: 71.4µs, p80:0s, p95:1ms, iters:14, tasks:14}, scan_detail: {total_process_keys: 32, total_process_keys_size: 10883, total_keys: 32, get_snapshot_time: 655.8µs, rocksdb: {block: {cache_hit_count: 138, read_count: 4, read_byte: 4.40 KB, read_time: 4.76µs}}}       | keep order:false, stats:partial[idx_hash:allEvicted]                                                                                                    | N/A     | N/A  |
+----------------------------------+---------+---------+-----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
5 rows in set (0.01 sec)
